<div class="modal-overlay" *ngIf="showModal">
  <div class="modal-container">
    <form [formGroup]="medicionForm" (ngSubmit)="onSubmit()">
      <h1 class="page-tittle">{{ isEditMode ? 'Editar Medición de Temperatura' : 'Registrar Medición de Temperatura' }}</h1>

      <div class="input-container">
        <label for="id_sensor">
          <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2C10.8954 2 10 2.89543 10 4V12.5351C8.86667 13.0766 8 14.1766 8 15.5C8 17.433 9.567 19 11.5 19C13.433 19 15 17.433 15 15.5C15 14.1766 14.1333 13.0766 13 12.5351V4C13 2.89543 12.1046 2 11 2H12Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <path d="M12 6H14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <path d="M12 9H14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <circle cx="11.5" cy="15.5" r="3.5" stroke="currentColor" stroke-width="1.5"/>
          </svg>
          <span>Sensor</span>
        </label>
        <div class="input" [ngClass]="{'is-invalid': isFieldInvalid('id_sensor')}">
          <mat-form-field appearance="outline">
            <mat-select id="id_sensor" formControlName="id_sensor">
              <mat-option value="">Seleccione un sensor</mat-option>
              <mat-option *ngFor="let sensor of sensores" [value]="sensor.id_sensor">
                {{ sensor.codigo_serie }} (ID: {{ sensor.id_sensor }})
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="text-error-message" *ngIf="isFieldInvalid('id_sensor')">
          <small>{{ getErrorMessage('id_sensor') }}</small>
        </div>
      </div>

      <div class="input-container">
        <label for="id_lote">
          <svg class="icono-1" viewBox="0 0 512 512" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M500.787,287.812c0.068-0.068,0.137-0.137,0.205-0.196c7.1-7.117,11.008-16.563,11.008-26.607v-13.542 c0-4.719-3.814-8.533-8.533-8.533h-23.953L322.193,176c-4.343-1.749-9.344,0.367-11.093,4.762 c-1.749,4.369,0.384,9.336,4.762,11.085l117.692,47.087H81.741l146.68-54.323c7.543,12.075,20.855,20.19,36.113,20.19 c23.526,0,42.667-19.14,42.667-42.667c0-20.608-14.686-37.845-34.133-41.805v-10.257c19.447-3.968,34.133-21.205,34.133-41.805 V8.533c0-4.719-3.814-8.533-8.533-8.533s-8.533,3.814-8.533,8.533v25.822c-7.151-5.419-15.957-8.755-25.6-8.755 c-9.643,0-18.449,3.337-25.6,8.755V8.533c0-4.719-3.814-8.533-8.533-8.533s-8.533,3.814-8.533,8.533v59.733 c0,20.599,14.686,37.837,34.133,41.805V128c0,4.719,3.814,8.533,8.533,8.533c14.114,0,25.6,11.486,25.6,25.6 s-11.486,25.6-25.6,25.6c-7.876,0-14.848-3.652-19.541-9.267l19.422-7.185l5.513,2.202c1.033,0.418,2.108,0.606,3.166,0.606 c3.379,0,6.579-2.022,7.927-5.367c1.749-4.369-0.375-9.335-4.762-11.085l-8.559-3.43c-0.384-0.154-0.785-0.119-1.178-0.213 c-0.623-0.154-1.22-0.341-1.869-0.35c-0.657-0.008-1.263,0.162-1.894,0.299c-0.393,0.085-0.794,0.043-1.195,0.188l-22.596,8.371 c0-0.128-0.034-0.239-0.034-0.367c0-4.719-3.814-8.533-8.533-8.533s-8.533,3.814-8.533,8.533c0,2.21,0.324,4.335,0.657,6.46 l-189.918,70.34H8.533c-4.719,0-8.533,3.814-8.533,8.533v13.559c0,9.916,4.028,19.618,11.034,26.624 c3.891,3.874,6.033,9.045,6.033,14.541v146.56c0,5.325-2.133,10.547-5.862,14.362c-0.06,0.068-0.128,0.137-0.196,0.196 C3.908,470.426,0,479.872,0,489.916v13.551C0,508.186,3.814,512,8.533,512h494.933c4.719,0,8.533-3.814,8.533-8.533v-13.534 c0-9.882-4.002-19.567-11.059-26.633c-3.814-3.84-6.007-9.131-6.007-14.532V302.182 C494.933,296.772,497.007,291.678,500.787,287.812z"/>
          </svg>
          <span>Lote</span>
        </label>
        <div class="input" [ngClass]="{'is-invalid': isFieldInvalid('id_lote')}">
          <mat-form-field appearance="outline">
            <mat-select id="id_lote" formControlName="id_lote">
              <mat-option value="">Seleccione un lote a medir</mat-option>
              <mat-option *ngFor="let lote of lotes" [value]="lote.id_lote">
                Lote {{ lote.id_lote }} - {{ lote.vacuna }} - {{lote.cantidad_inicial_unidades}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="text-error-message" *ngIf="isFieldInvalid('id_lote')">
          <small>{{ getErrorMessage('id_lote') }}</small>
        </div>
      </div>

      <div class="input-container">
        <label for="temperatura">
          <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span>Temperatura (°C)</span>
        </label>
        <div class="input" [ngClass]="{'is-invalid': isFieldInvalid('temperatura_c')}">
          <input type="number" id="temperatura_c" formControlName="temperatura_c" placeholder="Ingrese la temperatura" step="0.1">
        </div>
        <div class="text-error-message" *ngIf="isFieldInvalid('temperatura_c')">
          <small>{{ getErrorMessage('temperatura_c') }}</small>
        </div>
      </div>

      <div class="flex-end" style="margin-top: 30px;">
        <button type="submit" class="btn btn-blue">
          <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M18.1716 1C18.702 1 19.2107 1.21071 19.5858 1.58579L22.4142 4.41421C22.7893 4.78929 23 5.29799 23 5.82843V20C23 21.6569 21.6569 23 20 23H4C2.34315 23 1 21.6569 1 20V4C1 2.34315 2.34315 1 4 1H18.1716ZM4 3C3.44772 3 3 3.44772 3 4V20C3 20.5523 3.44772 21 4 21L5 21L5 15C5 13.3431 6.34315 12 8 12L16 12C17.6569 12 19 13.3431 19 15V21H20C20.5523 21 21 20.5523 21 20V6.82843C21 6.29799 20.7893 5.78929 20.4142 5.41421L18.5858 3.58579C18.2107 3.21071 17.702 3 17.1716 3H17V5C17 6.65685 15.6569 8 14 8H10C8.34315 8 7 6.65685 7 5V3H4ZM17 21V15C17 14.4477 16.5523 14 16 14L8 14C7.44772 14 7 14.4477 7 15L7 21L17 21ZM9 3H15V5C15 5.55228 14.5523 6 14 6H10C9.44772 6 9 5.55228 9 5V3Z" fill="currentColor"/>
          </svg>
          <span>{{ isEditMode ? 'Actualizar Medición' : 'Guardar Medición' }}</span>
        </button>

        <button type="button" class="btn btn-secondary" (click)="onCancel()">
          <svg class="icono-1" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <title>cancel</title>
              <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="work-case" fill="#000000" transform="translate(91.520000, 91.520000)">
                  <polygon id="Close"
                    points="328.96 30.2933333 298.666667 1.42108547e-14 164.48 134.4 30.2933333 1.42108547e-14 1.42108547e-14 30.2933333 134.4 164.48 1.42108547e-14 298.666667 30.2933333 328.96 164.48 194.56 298.666667 328.96 328.96 298.666667 194.56 164.48">
                  </polygon>
                </g>
              </g>
            </g>
          </svg>
          <span>Cancelar</span>
        </button>
      </div>

    </form>
  </div>
</div>