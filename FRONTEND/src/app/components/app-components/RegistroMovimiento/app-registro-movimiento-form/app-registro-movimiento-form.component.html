<div class="modal-overlay" *ngIf="showModal" (click)="cerrarModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <form [formGroup]="movimientoForm" (ngSubmit)="onSubmit()">
      <h1 class="page-tittle">{{ isEditMode ? 'Editar movimiento' : 'Registrar Movimiento' }}</h1>

      <div class="input-container">
        <label for="id_lote">
          <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <path d="M9 12L11 14L15 10M21 12C21 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C21.5093 4.43821 21.8356 5.80655 21.9449 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </g>
          </svg>
          <span>Lote</span>
        </label>
        <div class="input" [ngClass]="{'is-invalid': isFieldInvalid('id_lote')}">
          <select id="id_lote" formControlName="id_lote">
            <option value="">Seleccione un lote</option>
            <option *ngFor="let lote of lotes" [value]="lote.id_lote">
              Lote {{ lote.id_lote }} - Vacuna {{ lote.id_vacuna }}
            </option>
          </select>
        </div>
        <div *ngIf="isFieldInvalid('id_lote')" class="text-error-message">
          <small>{{ getErrorMessage('id_lote') }}</small>
        </div>
      </div>

      <div class="input-container">
        <label for="ubicacion_origen">
          <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" stroke="currentColor" stroke-width="1.5"/>
            </g>
          </svg>
          <span>Ubicación Origen</span>
        </label>
        <div class="input" [ngClass]="{'is-invalid': isFieldInvalid('ubicacion_origen')}">
          <select id="ubicacion_origen" formControlName="ubicacion_origen">
            <option value="">Seleccione ubicación origen</option>
            <option *ngFor="let ubicacion of ubicaciones" [value]="ubicacion.id_ubicacion">
              {{ ubicacion.nombre }}
            </option>
          </select>
        </div>
        <div *ngIf="isFieldInvalid('ubicacion_origen')" class="text-error-message">
          <small>{{ getErrorMessage('ubicacion_origen') }}</small>
        </div>
      </div>

      <div class="input-container">
        <label for="ubicacion_destino">
          <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" stroke="currentColor" stroke-width="1.5"/>
            </g>
          </svg>
          <span>Ubicación Destino</span>
        </label>
        <div class="input" [ngClass]="{'is-invalid': isFieldInvalid('ubicacion_destino')}">
          <select id="ubicacion_destino" formControlName="ubicacion_destino">
            <option value="">Seleccione ubicación destino</option>
            <option *ngFor="let ubicacion of ubicaciones" [value]="ubicacion.id_ubicacion">
              {{ ubicacion.nombre }}
            </option>
          </select>
        </div>
        <div *ngIf="isFieldInvalid('ubicacion_destino')" class="text-error-message">
          <small>{{ getErrorMessage('ubicacion_destino') }}</small>
        </div>
      </div>

      <div class="input-container">
        <label for="id_transportista">
          <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <path d="M3 7V17C3 18.1046 3.89543 19 5 19H19C20.1046 19 21 18.1046 21 17V7C21 5.89543 20.1046 5 19 5H5C3.89543 5 3 5.89543 3 7Z" stroke="currentColor" stroke-width="1.5"/>
              <path d="M8 5V3C8 2.44772 8.44772 2 9 2H15C15.5523 2 16 2.44772 16 3V5" stroke="currentColor" stroke-width="1.5"/>
              <circle cx="7" cy="12" r="1" fill="currentColor"/>
              <circle cx="17" cy="12" r="1" fill="currentColor"/>
            </g>
          </svg>
          <span>Transportista</span>
        </label>
        <div class="input" [ngClass]="{'is-invalid': isFieldInvalid('id_transportista')}">
          <select id="id_transportista" formControlName="id_transportista">
            <option value="">Seleccione un transportista</option>
            <option *ngFor="let transportista of transportistas" [value]="transportista.id_transportista">
              {{ transportista.nombre }}
            </option>
          </select>
        </div>
        <div *ngIf="isFieldInvalid('id_transportista')" class="text-error-message">
          <small>{{ getErrorMessage('id_transportista') }}</small>
        </div>
      </div>

      <div class="input-container">
        <label for="fecha_envio">
          <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="1.5"/>
              <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="1.5"/>
            </g>
          </svg>
          <span>Fecha de Envío</span>
        </label>
        <div class="input" [ngClass]="{'is-invalid': isFieldInvalid('fecha_envio')}">
          <input type="date" id="fecha_envio" formControlName="fecha_envio">
        </div>
        <div *ngIf="isFieldInvalid('fecha_envio')" class="text-error-message">
          <small>{{ getErrorMessage('fecha_envio') }}</small>
        </div>
      </div>

      <div class="input-container">
        <label for="fecha_recepcion">
          <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="1.5"/>
              <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="1.5"/>
            </g>
          </svg>
          <span>Fecha de Recepción</span>
        </label>
        <div class="input" [ngClass]="{'is-invalid': isFieldInvalid('fecha_recepcion')}">
          <input type="date" id="fecha_recepcion" formControlName="fecha_recepcion">
        </div>
        <div *ngIf="isFieldInvalid('fecha_recepcion')" class="text-error-message">
          <small>{{ getErrorMessage('fecha_recepcion') }}</small>
        </div>
      </div>

      <div class="flex-between">
        <button type="button" (click)="cerrarModal()" class="btn btn-secondary">
          <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <path d="M6 18L18 6M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </g>
          </svg>
          <span>Cancelar</span>
        </button>
        <button type="submit" class="btn btn-primary" [disabled]="movimientoForm.invalid">
          {{ isEditMode ? 'Actualizar' : 'Crear' }}
        </button>
      </div>
    </form>
  </div>
</div>