<div class="modal-overlay" *ngIf="showModal" >
    <div class="modal-container" (click)="$event.stopPropagation()">
        <form [formGroup]="alertaForm" (ngSubmit)="onSubmit()">
            <h1 class="page-tittle">{{ isEditMode ? 'Editar Alerta de Cadena de Frío' : 'Crear Alerta de Cadena de Frío' }}</h1>
            <div class="input-container">
                <label for="id_medicion">
                    <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                        <g id="SVGRepo_iconCarrier">
                            <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </g>
                    </svg>
                    <span>Medición</span>
                </label>
                <div class="input" [ngClass]="{'is-invalid': isFieldInvalid('id_medicion')}">
                    
                    <mat-form-field appearance="outline">
                        <mat-select id="id_medicion" formControlName="id_medicion">
                            <mat-option value="">Seleccione una medición</mat-option>
                            <mat-option *ngFor="let medicion of mediciones" [value]="medicion.id_medicion">
                                {{ medicion.id_medicion }} - {{ medicion.temperatura_c }}°C
                            </mat-option>
                        </mat-select>
                    </mat-form-field>



                    

                </div>
                <div *ngIf="isFieldInvalid('id_medicion')" class="text-error-message">
                    <small>{{ getErrorMessage('id_medicion') }}</small>
                </div>
            </div>
            <div class="input-container">
                <label for="id_lote">
                    <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                        <g id="SVGRepo_iconCarrier">
                            <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </g>
                    </svg>
                    <span>Lote</span>
                </label>
                <div class="input" [ngClass]="{'is-invalid': isFieldInvalid('id_lote')}">
                    <mat-form-field appearance="outline">
                        <mat-select id="id_lote" formControlName="id_lote">
                            <mat-option value="">Seleccione un lote</mat-option>
                            <mat-option *ngFor="let lote of lotes" [value]="lote.id_lote">
                                Lote {{ lote.id_lote }} - {{ lote.vacuna }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div *ngIf="isFieldInvalid('id_lote')" class="text-error-message">
                    <small>{{ getErrorMessage('id_lote') }}</small>
                </div>
            </div>
            <div class="input-container">
                <label for="tipo_alerta">
                    <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                        <g id="SVGRepo_iconCarrier">
                            <path d="M12 9V11M12 15H12.01M5.07183 19H18.9282C20.4678 19 21.4301 17.3333 20.6603 15.952L13.7321 4.04798C12.9623 2.66667 11.0378 2.66667 10.268 4.04798L3.33978 15.952C2.56998 17.3333 3.53222 19 5.07183 19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </g>
                    </svg>
                    <span>Tipo de Alerta</span>
                </label>
                <div class="input" [ngClass]="{'is-invalid': isFieldInvalid('tipo_alerta')}">
                    <mat-form-field appearance="outline">
                        <mat-select id="tipo_alerta" formControlName="tipo_alerta">
                            <mat-option value="">Seleccione un tipo de alerta</mat-option>
                            <mat-option value="Máx. Excedida">Máx. Excedida</mat-option>
                            <mat-option value="Mín. Violada">Mín. Violada</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div *ngIf="isFieldInvalid('tipo_alerta')" class="text-error-message">
                    <small>{{ getErrorMessage('tipo_alerta') }}</small>
                </div>
            </div>
              <div class="flex-end" style="margin-top: 30px;">
                <button type="submit" class="btn btn-blue">
                    <svg class="icono-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                        <g id="SVGRepo_iconCarrier">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M18.1716 1C18.702 1 19.2107 1.21071 19.5858 1.58579L22.4142 4.41421C22.7893 4.78929 23 5.29799 23 5.82843V20C23 21.6569 21.6569 23 20 23H4C2.34315 23 1 21.6569 1 20V4C1 2.34315 2.34315 1 4 1H18.1716ZM4 3C3.44772 3 3 3.44772 3 4V20C3 20.5523 3.44772 21 4 21L5 21L5 15C5 13.3431 6.34315 12 8 12L16 12C17.6569 12 19 13.3431 19 15V21H20C20.5523 21 21 20.5523 21 20V6.82843C21 6.29799 20.7893 5.78929 20.4142 5.41421L18.5858 3.58579C18.2107 3.21071 17.702 3 17.1716 3H17V5C17 6.65685 15.6569 8 14 8H10C8.34315 8 7 6.65685 7 5V3H4ZM17 21V15C17 14.4477 16.5523 14 16 14L8 14C7.44772 14 7 14.4477 7 15L7 21L17 21ZM9 3H15V5C15 5.55228 14.5523 6 14 6H10C9.44772 6 9 5.55228 9 5V3Z"
                                fill="currentColor"></path>
                        </g>
                    </svg>
                    <span>{{ isEditMode ? 'Actualizar Alerta' : 'Guardar Alerta' }}</span>
                </button>
                <button type="button" class="btn btn-secondary" (click)="onCancel()">
                    <svg class="icono-1" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000">
                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                        <g id="SVGRepo_iconCarrier">
                            <title>cancel</title>
                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                <g id="work-case" fill="#000000" transform="translate(91.520000, 91.520000)">
                                    <polygon id="Close"
                                        points="328.96 30.2933333 298.666667 1.42108547e-14 164.48 134.4 30.2933333 1.42108547e-14 1.42108547e-14 30.2933333 134.4 164.48 1.42108547e-14 298.666667 30.2933333 328.96 164.48 194.56 298.666667 328.96 328.96 298.666667 194.56 164.48">
                                    </polygon>
                                </g>
                            </g>
                        </g>
                    </svg>
                    <span>Cancelar</span>
                </button>
            </div>
        </form>
    </div>
</div>